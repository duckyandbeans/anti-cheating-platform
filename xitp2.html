<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XI TP 2: Final MCQ Assessment</title>
    <style>
        :root { --primary: #2563eb; --bg: #f8fafc; --text: #1e293b; --success: #10b981; --danger: #ef4444; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg); padding: 20px; color: var(--text); user-select: none; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; }
        
        h1, h2 { text-align: center; color: var(--primary); margin-bottom: 10px; }
        .btn { display: block; width: 100%; padding: 1rem; background: var(--primary); color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 20px; font-size: 1rem; transition: 0.2s; }
        .btn:hover { background: #1d4ed8; }
        .btn:disabled { background: #94a3b8; cursor: not-allowed; }
        
        /* INPUT STYLES */
        input[type="text"], input[type="number"], select { 
            width: 100%; padding: 0.8rem; border: 1px solid #cbd5e1; border-radius: 6px; margin-bottom: 15px; box-sizing: border-box; font-size: 1rem; 
        }
        label { font-weight: 600; display: block; margin-bottom: 5px; color: #475569; }

        /* --- INTELLIGENT READING LAYOUT --- */
        
        /* DESKTOP: Split View (Side by Side) */
        .split-container {
            display: flex;
            flex-direction: row;
            height: 600px; /* Fixed height for desktop to allow internal scrolling */
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 40px;
            background: #fff;
        }
        .reading-pane {
            flex: 1;
            padding: 25px;
            background: #fff7ed;
            color: #7c2d12;
            overflow-y: auto; /* Scrollable */
            border-right: 2px solid #fed7aa;
            font-size: 1rem;
            line-height: 1.7;
        }
        .questions-pane {
            flex: 1;
            padding: 25px;
            background: #f8fafc;
            overflow-y: auto; /* Scrollable */
        }

        /* MOBILE FIX: Stacked View */
        @media (max-width: 768px) {
            .split-container {
                display: flex;
                flex-direction: column; /* Stack vertically */
                height: auto !important; /* Allow page to grow naturally */
                border: none;
            }
            .reading-pane {
                flex: none;
                width: 100%;
                max-height: 300px; /* Limit height so it doesn't take whole screen */
                overflow-y: auto;  /* Allow scrolling INSIDE the text box */
                border: 2px solid #fed7aa;
                border-radius: 8px;
                margin-bottom: 15px;
                box-sizing: border-box; /* Prevent padding issues */
            }
            .questions-pane {
                flex: none;
                width: 100%;
                height: auto;
                overflow: visible; /* Let the page scroll naturally */
                padding: 0;
            }
        }
        
        /* QUESTION BOX STYLES */
        .question-box { background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #e2e8f0; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        .question-text { font-weight: 700; font-size: 1rem; margin-bottom: 10px; line-height: 1.5; }
        
        .mcq-label { display: flex; align-items: flex-start; padding: 10px; background: #f8fafc; border: 1px solid #e2e8f0; margin-top: 6px; border-radius: 6px; cursor: pointer; transition: 0.1s; }
        .mcq-label:hover { border-color: var(--primary); background: #eff6ff; }
        
        .mcq-input { width: auto !important; margin-right: 12px; margin-top: 4px; transform: scale(1.3); flex-shrink: 0; }
        .mcq-input:checked + span { color: var(--primary); font-weight: 700; }

        /* WATERMARK */
        .watermark-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9999; opacity: 0.04; display: flex; flex-wrap: wrap; overflow: hidden; }
        .watermark-text { transform: rotate(-30deg); margin: 60px; font-weight: 900; font-size: 20px; color: #000; }

        /* ALERTS */
        #cheat-alert { background: #fee2e2; color: #991b1b; padding: 1rem; border-radius: 8px; display: none; text-align: center; font-weight: bold; margin-bottom: 20px; border: 1px solid #f87171; }
        .cheat-counter { position: fixed; top: 15px; right: 15px; background: #fee2e2; color: #dc2626; padding: 6px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: bold; border: 1px solid #dc2626; z-index: 1000; display:none; }

        /* RESULTS */
        .result-box { text-align: center; padding: 30px; background: #ecfdf5; border: 2px solid var(--success); border-radius: 12px; }
        .wrong-list { margin-top: 20px; color: #dc2626; font-size: 0.95rem; text-align: left; background: white; padding: 15px; border-radius: 8px; border: 1px solid #fecaca; }

        #login-section, #system-check-section, #quiz-section { display: none; }
        #login-section { display: block; }
    </style>
    
    <script src="https://www.gstatic.com/firebasejs/10.13.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.13.0/firebase-firestore-compat.js"></script>
</head>
<body oncontextmenu="return false;">

<div id="global-watermark" class="watermark-overlay"></div>
<div id="cheat-display" class="cheat-counter">Cheats: 0</div>

<div class="container">
    <div id="cheat-alert">⚠️ TAB SWITCH DETECTED! THIS INCIDENT IS RECORDED.</div>

    <div id="login-section">
        <h1>XI TP 2: Final Assessment</h1>
        <p style="text-align:center; color:#64748b; margin-bottom: 30px;">Multiple Choice Section (40 Questions)</p>
        
        <label>Class</label>
        <select id="studentClass">
            <option value="">Select Class...</option>
            <option value="XI D">XI D</option>
            <option value="XI E">XI E</option>
            <option value="XI H">XI H</option>
            <option value="XI I">XI I</option>
        </select>
        <label>Attendance No.</label>
        <input type="number" id="studentNo" placeholder="e.g. 15">
        <label>Full Name</label>
        <input type="text" id="studentName" placeholder="Enter Full Name">
        <button class="btn" onclick="verifyLogin()">Login / Resume</button>
    </div>

    <div id="system-check-section">
        <h2>⚠️ Exam Rules</h2>
        <div style="background:#fff7ed; border:1px solid #fdba74; padding:15px; border-radius:8px; margin-bottom:20px;">
            <p>1. <strong>40 Questions:</strong> Vocabulary, Grammar, Reading.</p>
            <p>2. <strong>Bonus Scoring:</strong> The passing score is calculated based on 30 items. (10 Bonus Items).</p>
            <p>3. <strong>Anti-Cheat:</strong> Do not switch tabs or minimize the browser.</p>
            <p>4. <strong>Auto-Save:</strong> Refresh if stuck.</p>
        </div>
        <div style="text-align: center;">
            <input type="checkbox" id="rulesCheck" onchange="document.getElementById('startBtn').disabled = !this.checked">
            <label for="rulesCheck" style="display:inline; margin-left:8px;">I understand and I am ready.</label>
        </div>
        <button class="btn" id="startBtn" onclick="startQuiz()" disabled>START EXAM</button>
    </div>

    <div id="quiz-section">
        <div style="display:flex; justify-content:space-between; margin-bottom:20px; font-weight:bold; border-bottom:2px solid #e2e8f0; padding-bottom:10px;">
            <span>XI Final Assessment</span>
            <span style="color:var(--danger); animation: pulse 2s infinite;">● Live Monitoring</span>
        </div>

        <div id="quiz-content-area"></div>

        <button class="btn" onclick="submitFinal()" style="background:var(--success);">Submit Final Answers</button>
    </div>
</div>

<script>
    // --- FIREBASE SETUP ---
    const firebaseConfig = {
      apiKey: "AIzaSyAB_on0WAobEXccxHvcwtS9ShxQpfATH-A",
      authDomain: "anti-cheating-remedial-quiz.firebaseapp.com",
      projectId: "anti-cheating-remedial-quiz",
      storageBucket: "anti-cheating-remedial-quiz.firebasestorage.app",
      messagingSenderId: "979294386230",
      appId: "1:979294386230:web:7f9ff3e377d4da20cd4097"
    };
    try { firebase.initializeApp(firebaseConfig); var db = firebase.firestore(); } catch(e){}

    const COLLECTION_NAME = "grade_xi_part2_mcq";
    let currentDocID = null;
    let switchCount = 0;
    let sessionActive = false;
    let userAnswers = {}; 

    // --- READING TEXTS ---
    const TEXT_PASSAGE_1 = `<strong>Passage 1: Mental Health in Elite Sport</strong><br><br>Elite athletes are often viewed as superhumans, possessing bodies and minds capable of enduring extreme stress. However, recent events in the sporting world have shone a light on the fragile mental health of these competitors. The pressure to win, combined with intense public scrutiny, can lead to severe anxiety and depression. Unlike in the past, where "toughing it out" was the norm, athletes are now speaking up.<br><br>One major issue is the identity crisis many athletes face. Their self-esteem is often entirely tied to their performance. When they suffer an injury or retire, they lose their sense of belonging and purpose. Furthermore, the constant travel and isolation from family remove their support systems, making them vulnerable. Sports psychologists are now an integral part of coaching teams, teaching coping mechanisms like mindfulness to help athletes maintain their focus and determination without sacrificing their well-being.`;

    const TEXT_PASSAGE_2 = `<strong>Passage 2: Interpreting Physical Education Data</strong><br><br>A recent study tracked 500 high school students to analyze the correlation between physical education (PE) and academic performance. The data, presented in the chart, reveals a clear trend. Students who participated in zero hours of PE per week had the lowest average GPA. As the hours of physical activity increased, so did the students' grades.<br><br>To explain more about that, researchers believe that physical activity stimulates blood flow to the brain and releases endorphins, which improve concentration and memory. However, the data also showed that beyond 7 hours of intense training, grades slightly dipped, likely due to fatigue and lack of study time. This suggests that while exercise is beneficial, balance is key.`;

    // --- FULL QUESTION DATA ---
    const MC_QUESTIONS = [
        // SECTION 1: VOCABULARY (1-15)
        {id:1, q:"After weeks of training for the marathon, her ______ finally paid off when she crossed the finish line.", opts:["anxiety","determination","pressure","well-being"], ans:"determination"},
        {id:2, q:"The yoga instructor emphasized being ______ of our breathing to reduce stress.", opts:["physical","mindful","anxious","least"], ans:"mindful"},
        {id:3, q:"Winning the science fair gave him a huge boost in ______, making him feel he could achieve anything.", opts:["self-confidence","attention span","endorphins","depression"], ans:"self-confidence"},
        {id:4, q:"Teenagers often seek a ______ within their peer groups because they want to feel accepted and safe.", opts:["sense of belonging","self-control","pressure","joy"], ans:"sense of belonging"},
        {id:5, q:"Studies show that regular exercise releases ______, which are chemicals in the brain that act as natural painkillers and mood elevators.", opts:["supports","endorphins","anxieties","spans"], ans:"endorphins"},
        {id:6, q:"The constant ______ to succeed in elite sports can sometimes lead to mental burnout.", opts:["joy","well-being","pressure","self-esteem"], ans:"pressure"},
        {id:7, q:"Now that we've discussed the benefits, ______ the potential risks involved.", opts:["let's start by","let's turn to","one reason may be","to explain more about that"], ans:"let's turn to"},
        {id:8, q:"The graph shows a significant rise in sales. ______, the bar chart illustrates a decline in production costs.", opts:["One reason may be","Another way that","To explain more about that","Let's start by"], ans:"Another way that"},
        {id:9, q:"His short ______ made it difficult for him to sit through the two-hour lecture without checking his phone.", opts:["self-control","attention span","well-being","determination"], ans:"attention span"},
        {id:10, q:"______ why the team failed is that they lacked proper communication during the match.", opts:["Let's turn to","One reason may be","Another way that","To explain more about that"], ans:"One reason may be"},
        {id:11, q:"Having high ______ means you generally feel good about your own worth as a person.", opts:["self-esteem","anxiety","pressure","support"], ans:"self-esteem"},
        {id:12, q:"When describing the pie chart, we can see that the 'Rent' section accounts for ______ 40% of the total expenses.", opts:["exactly","roughly","much more","least"], ans:"roughly"},
        {id:13, q:"The doctor was concerned about the patient's general ______, suggesting a better diet and more sleep to improve their health.", opts:["well-being","determination","belonging","self-control"], ans:"well-being"},
        {id:14, q:"______ exercise helps mental health is by reducing levels of stress hormones in the body.", opts:["Let's turn to","Another way that","One reason may be","To explain more about that"], ans:"Another way that"},
        {id:15, q:"Without the ______ of her family and friends, she wouldn't have been able to finish her degree during such a hard time.", opts:["support","pressure","anxiety","depression"], ans:"support"},
        
        // SECTION 2: GRAMMAR (16-25)
        {id:16, q:"The new stadium ______ by the city council next year.", opts:["is built","was built","will be built","has been built"], ans:"will be built"},
        {id:17, q:"This year's exam was ______ difficult than last year's; almost everyone failed.", opts:["much more","little","the least","as"], ans:"much more"},
        {id:18, q:"Of all the runners, she was the ______ exhausted after the race.", opts:["less","most","more","much"], ans:"most"},
        {id:19, q:"English ______ in many countries around the world as a second language.", opts:["speaks","is speaking","is spoken","spoke"], ans:"is spoken"},
        {id:20, q:"That was the ______ interesting movie I have ever seen; I fell asleep twice.", opts:["least","less","most","more"], ans:"least"},
        {id:21, q:"The results ______ to the students by email yesterday.", opts:["are sent","were sent","have been sent","send"], ans:"were sent"},
        {id:22, q:"My new laptop is ______ faster than my old one.", opts:["many","a lot","very","as"], ans:"a lot"},
        {id:23, q:"The problem ______ right now by the technical team.", opts:["is solved","is being solved","was solved","solves"], ans:"is being solved"},
        {id:24, q:"This route is slightly ______ than the one we took yesterday.", opts:["long","longest","longer","the longest"], ans:"longer"},
        {id:25, q:"Many mistakes ______ in the final report, which caused confusion.", opts:["were made","made","are making","have made"], ans:"were made"},

        // SECTION 3: READING 1 (26-30)
        {id:26, q:"According to the text, why are elite athletes vulnerable to mental health issues?", opts:["They are physically weaker than average people.","They face intense pressure to win and public judgment.","They do not have enough time to train.","They lack determination."], ans:"They face intense pressure to win and public judgment."},
        {id:27, q:"What does the phrase 'toughing it out' imply about the past attitude in sports?", opts:["Athletes used to be physically stronger.","Athletes were encouraged to ignore their mental struggles.","Athletes were more open about their feelings.","Athletes preferred tough competitions."], ans:"Athletes were encouraged to ignore their mental struggles."},
        {id:28, q:"Why is retirement or injury particularly difficult for elite athletes?", opts:["They lose their financial income immediately.","They lose their sense of identity and belonging.","They have to find new hobbies.","They are no longer famous."], ans:"They lose their sense of identity and belonging."},
        {id:29, q:"The text suggests that self-esteem in athletes is often linked to:", opts:["Their family support.","Their physical appearance.","Their performance in their sport.","Their wealth."], ans:"Their performance in their sport."},
        {id:30, q:"What role do sports psychologists play now?", opts:["They replace the physical coaches.","They help athletes ignore their emotions.","They teach coping mechanisms like mindfulness.","They manage the athletes' travel schedules."], ans:"They teach coping mechanisms like mindfulness."},

        // SECTION 3: READING 2 (31-40)
        {id:31, q:"What is the main trend shown in the imagined chart described in the text?", opts:["More PE hours generally lead to lower GPAs.","There is no relationship between PE and grades.","More PE hours generally correspond to higher GPAs.","Students who don't exercise have the highest grades."], ans:"More PE hours generally correspond to higher GPAs."},
        {id:32, q:"Based on the text, what happens to students who train for more than 7 hours a week?", opts:["Their grades continue to skyrocket.","Their grades slightly decline.","They become professional athletes.","They concentration improves indefinitely."], ans:"Their grades slightly decline."},
        {id:33, q:"Which vocabulary phrase is used in the text to introduce a deeper reason for the findings?", opts:["Let's turn to","One reason may be","To explain more about that","Another way that"], ans:"To explain more about that"},
        {id:34, q:"According to the researchers, why does exercise help academic performance?", opts:["It makes students too tired to misbehave.","It releases endorphins and improves concentration.","It guarantees admission to college.","It reduces the time spent on video games."], ans:"It releases endorphins and improves concentration."},
        {id:35, q:"What conclusion does the text draw about exercise?", opts:["It is only for elite athletes.","It is dangerous for students.","Balance is key; too much can be detrimental.","It should replace all academic classes."], ans:"Balance is key; too much can be detrimental."},
        {id:36, q:"The word 'correlation' in the text is closest in meaning to:", opts:["Difference","Connection","Problem","Separation"], ans:"Connection"},
        {id:37, q:"If a student exercises 0 hours a week, their GPA is likely to be:", opts:["The highest in the class.","The lowest among the groups studied.","Exactly 3.0.","Unaffected."], ans:"The lowest among the groups studied."},
        {id:38, q:"The text implies that endorphins help with:", opts:["Muscle growth only.","Sleeping patterns.","Memory and concentration.","Social skills."], ans:"Memory and concentration."},
        {id:39, q:"The 'dip' in grades after 7 hours is attributed to:", opts:["Lack of interest.","Fatigue and less time to study.","Too many endorphins.","Poor coaching."], ans:"Fatigue and less time to study."},
        {id:40, q:"What is the best title for Passage 2?", opts:["Why PE Should Be Banned.","The Dangers of Elite Sport.","The Link Between Physical Activity and Academic Success.","How to Train for a Marathon."], ans:"The Link Between Physical Activity and Academic Success."}
    ];

    // --- WATERMARK ---
    function initWatermark() {
        const wm = document.getElementById('global-watermark');
        let html = "";
        for(let i=0; i<40; i++) html += `<div class="watermark-text">THIS IS AN EXAM<br>DO NOT CHEAT</div>`;
        wm.innerHTML = html;
    }
    initWatermark();

    // --- LOGIN & RESTORE ---
    async function verifyLogin() {
        const cls = document.getElementById('studentClass').value;
        const no = document.getElementById('studentNo').value;
        const name = document.getElementById('studentName').value;

        if(!cls || !no || !name) return alert("Fill all fields");

        currentDocID = `${cls.replace(/\s/g,'')}_${no}_${name.replace(/\s/g,'_')}`;
        
        // CHECK IF ALREADY SUBMITTED
        const docSnap = await db.collection(COLLECTION_NAME).doc(currentDocID).get();
        if(docSnap.exists && docSnap.data().status === "COMPLETED") {
            alert("You have already submitted this exam. You cannot enter again.");
            return;
        }

        document.getElementById('login-section').style.display='none';
        document.getElementById('system-check-section').style.display='block';
    }

    async function startQuiz() {
        const cls = document.getElementById('studentClass').value;
        const no = document.getElementById('studentNo').value;
        const name = document.getElementById('studentName').value;

        const docRef = db.collection(COLLECTION_NAME).doc(currentDocID);
        const docSnap = await docRef.get();

        if (docSnap.exists) {
            const data = docSnap.data();
            switchCount = data.cheat_count || 0;
            userAnswers = data.temp_answers || {};
        } else {
            await docRef.set({
                class: cls, number: no, name: name,
                start_time: new Date().toLocaleString(),
                status: "IN_PROGRESS",
                cheat_count: 0,
                temp_answers: {}
            });
        }

        renderQuizLayout();
        document.getElementById('system-check-section').style.display='none';
        document.getElementById('quiz-section').style.display='block';
        document.getElementById('cheat-display').style.display='block';
        document.getElementById('cheat-display').innerText = `Cheats: ${switchCount}`;
        
        sessionActive = true;
        document.documentElement.requestFullscreen().catch(e=>{});
    }

    // --- ADVANCED RENDER (SPLIT & STANDARD) ---
    function renderQuizLayout() {
        const contentArea = document.getElementById('quiz-content-area');
        contentArea.innerHTML = "";
        
        // 1. STANDARD SECTION (Vocabulary + Grammar: Q1-25)
        let standardHTML = `<div class="standard-section"><h2>Part 1: Vocabulary & Grammar</h2>`;
        
        for(let i=0; i<25; i++) {
            const q = MC_QUESTIONS[i];
            standardHTML += createQuestionHTML(q);
        }
        standardHTML += `</div><hr style="margin:40px 0; border:0; border-top:2px solid #ddd;">`;
        contentArea.innerHTML += standardHTML;

        // 2. READING SECTION 1 (Q26-30) - SPLIT PANE
        contentArea.innerHTML += `<h2>Part 2: Reading Comprehension 1</h2>`;
        contentArea.innerHTML += createSplitPane(TEXT_PASSAGE_1, MC_QUESTIONS.slice(25, 30));

        // 3. READING SECTION 2 (Q31-40) - SPLIT PANE
        contentArea.innerHTML += `<hr style="margin:40px 0; border:0; border-top:2px solid #ddd;"><h2>Part 3: Reading Comprehension 2</h2>`;
        contentArea.innerHTML += createSplitPane(TEXT_PASSAGE_2, MC_QUESTIONS.slice(30, 40));
    }

    // Helper: Create HTML for a single question box
    function createQuestionHTML(q) {
        let optionsHTML = "";
        q.opts.forEach(opt => {
            const isChecked = (userAnswers[`Q${q.id}`] === opt) ? "checked" : "";
            optionsHTML += `
                <label class="mcq-label">
                    <input type="radio" class="mcq-input" name="q_${q.id}" value="${opt}" ${isChecked} onchange="saveProgress('Q${q.id}', '${opt}')">
                    <span>${opt}</span>
                </label>`;
        });
        return `
            <div class="question-box">
                <div class="question-text">${q.id}. ${q.q}</div>
                ${optionsHTML}
            </div>`;
    }

    // Helper: Create Split Pane HTML
    function createSplitPane(text, questionsArray) {
        let questionsHTML = "";
        questionsArray.forEach(q => {
            questionsHTML += createQuestionHTML(q);
        });

        return `
            <div class="split-container">
                <div class="reading-pane">${text}</div>
                <div class="questions-pane">${questionsHTML}</div>
            </div>
        `;
    }

    // --- AUTO-SAVE ---
    function saveProgress(qKey, value) {
        userAnswers[qKey] = value;
        db.collection(COLLECTION_NAME).doc(currentDocID).update({
            temp_answers: userAnswers
        }, { merge: true });
    }

    // --- SUBMISSION ---
    async function submitFinal() {
        if(!confirm("Are you sure? You cannot change answers after submitting.")) return;
        
        sessionActive = false;
        let correctCount = 0;
        let wrongList = [];

        MC_QUESTIONS.forEach(q => {
            const userVal = userAnswers[`Q${q.id}`];
            if(userVal === q.ans) {
                correctCount++;
            } else {
                wrongList.push(q.id);
            }
        });

        // Scoring: Based on 30 questions
        let rawScore = Math.round((correctCount / 30) * 100);
        
        await db.collection(COLLECTION_NAME).doc(currentDocID).update({
            status: "COMPLETED",
            finish_time: new Date().toLocaleString(),
            final_score: rawScore,
            correct_count: correctCount,
            wrong_list: wrongList,
            final_cheat_count: switchCount
        });

        document.body.innerHTML = `
            <div class="container">
                <div class="result-box">
                    <h1 style="color:var(--success)">Assessment Submitted</h1>
                    <div style="font-size:3rem; font-weight:bold; margin:20px 0;">${rawScore}</div>
                    <p>Score based on 30 items (Bonus applied).</p>
                    <hr>
                    <p><strong>Total Correct:</strong> ${correctCount} / 40</p>
                    <p><strong>Total Wrong:</strong> ${40 - correctCount}</p>
                    
                    <div class="wrong-list">
                        <strong>Questions you missed:</strong><br>
                        ${wrongList.length > 0 ? wrongList.join(", ") : "None! Perfect Score!"}
                    </div>
                </div>
                <button class="btn" onclick="location.reload()" style="background:#64748b; margin-top:20px;">Close Exam</button>
            </div>
        `;
    }

    // --- ANTI-CHEAT ---
    document.addEventListener("visibilitychange", () => {
        if(document.hidden && sessionActive) {
            switchCount++;
            document.getElementById('cheat-display').innerText = `Cheats: ${switchCount}`;
            document.getElementById('cheat-alert').style.display = 'block';
            setTimeout(() => document.getElementById('cheat-alert').style.display='none', 3000);
            db.collection(COLLECTION_NAME).doc(currentDocID).update({ cheat_count: switchCount });
        }
    });
</script>
</body>
</html>
